<h3>Top Contributors
  <span class="badge badge-info"><%= @top_contributors.length %></span> 
  <%= link_to "Export as CSV", url_for(params.merge(format: :csv)), class: 'btn pull-right' %>
</h3>

<form class="well form-search">
  <input type="text" name='search' value='<%= params[:search]%>' class="input-medium search-query">
  <button type="submit" class="btn">Search</button>
</form>

<%= render 'flash_notices' %>

<table class='table table-striped table-condensed'>
  <thead>
    <tr>
      <th>&nbsp;</th>
      <th>Avatar</th>
      <th><%=sortable("username")%></th>
      <th><%=sortable("full_name","Full Name")%></th>
      <th><%=sortable("email")%></th>
      <th><%=sortable("photos_count","Photos")%></th>
      <th><%=sortable("follows_count","Follows")%></th>
      <th><%=sortable("platform","Platform")%></th>
      <th><%=sortable("user_flags_count", "Flag Count")%></th>
      <th><%=sortable("created_at","Created")%></th>
    </tr>
  </thead>
  <tbody>
    <% @top_contributors.each_with_index do |u, i| %>
    <% fotos_cnt = u.photos_count %>
    <tr id='usr_<%= u.id.to_s %>'>
      <td><%= (@page - 1) * @lmt + i + 1 %></td>
      <td><img src='<%= u.url_thumb %>' /></td>
      <td><%= u.username %></td>
      <td><%= u.full_name %></td>
      <td><%= u.email %></td>
      <% if fotos_cnt > 0 %>
        <td><%= link_to fotos_cnt, '/admin/photos?user_id='+u.id.to_s %></td>
      <% else %>
        <td><%= fotos_cnt %></td>
      <% end %>
      <td><%= u.follows_count %></td>
      <td><%= u.platform %></td>
      <td><%= u.user_flags_count %></td>
      <td><%= u.created_dt %></td>
    </tr>
    <% end %>
  </tbody>
</table>

<% if params[:search].to_s.blank? %>
<ul class='pager'>
  <li class='previous <%= 'disabled' if @page == 1 %>'>
    <%= link_to "&larr; Previous".html_safe, url_for(params.merge(page: @page - 1)) %>
  </li>
  <li class='next <%= 'disabled' if @page >= @max_page %>'>
    <%= link_to "Next &rarr;".html_safe, url_for(params.merge(page: @page + 1)) %>
  </li>
</ul>
<% end %>
